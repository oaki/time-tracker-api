{"version":3,"sources":["libs/fetchWithTimeout.js","api.js","pages/loginPage.js","hooks/useGeoLocation.js","reducer.js","App.js","pages/mainPage.js","hooks/useRefCallback.js","version.js","serviceWorker.js","index.js","images/inteles_logo.svg"],"names":["fetchWithTimeout","url","options","timeout","Promise","race","fetch","_","reject","setTimeout","Error","config","apiHost","getToken","props","a","password","headers","method","Headers","response","ok","console","error","json","save","formData","FormData","Object","keys","forEach","key","append","body","saveImage","image","imageRes","blob","userToken","logId","CssTextField","withStyles","root","color","TextField","LoginPage","inputEl","useRef","onButtonClick","current","value","res","token","appDispatch","type","payload","fullWidth","inputRef","required","id","label","margin","variant","Button","size","onClick","LockOpen","useGeolocation","enableHighAccuracy","maximumAge","useState","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","state","setState","watchId","setWatchId","setError","useEffect","navigator","geolocation","getCurrentPosition","coords","err","newWatchId","watchPosition","clearWatch","reducer","action","isLoading","showSuccess","appReducer","localStorage","setItem","TOKEN_NAME","cameraPhotoInstance","useStyles","makeStyles","theme","display","alignItems","background","padding","width","buttonSuccess","backgroundColor","green","buttonProgress","position","top","left","marginTop","marginLeft","initialState","tryToStart","handleStart","dispatch","getUserToken","lat","lng","sizeFactor","imageType","imageCompression","getDataUri","timer","BtnContainer","styled","div","MainPage","useReducer","classes","node","setNode","useCallback","element","useRefCallback","videoNode","setVideoNode","isCameraStarted","setIsCameraStarted","geoError","clearInterval","undefined","CameraPhoto","startCamera","FACING_MODES","USER","then","stream","log","catch","Sentry","msg","message","style","height","ref","autoPlay","src","alt","className","disabled","CircularProgress","VERSION","dsn","getItem","defaultAppState","App","appState","logo","bottom","fontSize","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","serviceWorker","ready","registration","unregister","module","exports"],"mappings":"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","file":"static/js/main.2a9d983e.chunk.js","sourcesContent":["export function fetchWithTimeout(url, options, timeout = 7000) {\n  return Promise.race([\n    fetch(url, options),\n    new Promise((_, reject) =>\n      setTimeout(() => reject(new Error(\"timeout\")), timeout)\n    )\n  ]);\n}","import {fetchWithTimeout} from \"./libs/fetchWithTimeout\";\n\nconst config = {\n  apiHost: \"https://inteles.bincik.sk\"\n}\n\nexport async function getToken(props) {\n  const url = `${config.apiHost}/api/auth?p=${props.password}`;\n  const headers = {\n    method: \"GET\",\n    headers: new Headers({}),\n    // mode: 'no-cors'\n  };\n\n  try {\n    const response = await fetch(url, headers);\n    if (!response.ok) {\n      console.error(response);\n      throw new Error(\"Loading failed\");\n    }\n\n    return await response.json();\n  } catch (e) {\n    throw new Error(e);\n  }\n}\n\nexport async function save(props) {\n  const url = `${config.apiHost}/api/save`;\n  const formData = new FormData();\n  Object.keys(props).forEach((key) => {\n    formData.append(key, props[key]);\n  });\n  const headers = {\n    method: \"POST\",\n    headers: new Headers({}),\n    body: formData,\n  };\n\n  try {\n    const response = await fetchWithTimeout(url, headers);\n    if (!response.ok) {\n      throw new Error(\"Loading failed\");\n    }\n\n    return await response.json();\n  } catch (e) {\n    throw new Error(e);\n  }\n}\n\n\nexport async function saveImage(props) {\n  const url = `${config.apiHost}/api/save-image`;\n  const formData = new FormData();\n\n  const imageRes = await fetch(props.image);\n  const blob = await imageRes.blob();\n\n  formData.append(\"image\", blob, \"thumb.jpg\");\n  formData.append(\"userToken\", props.userToken);\n  formData.append(\"log_id\", props.logId);\n  const headers = {\n    method: \"POST\",\n    headers: new Headers({}),\n    body: formData\n  };\n\n  try {\n    const response = await fetchWithTimeout(url, headers);\n    if (!response.ok) {\n      throw new Error(\"Loading failed\");\n    }\n\n    return await response.json();\n  } catch (e) {\n    throw new Error(e);\n  }\n}","import Button from \"@material-ui/core/Button\";\nimport withStyles from \"@material-ui/core/styles/withStyles\";\nimport TextField from \"@material-ui/core/TextField\";\nimport {LockOpen} from \"@material-ui/icons\";\nimport React, {useRef} from \"react\";\nimport {getToken} from \"../api\";\n\n\nconst CssTextField = withStyles({\n  root: {\n    \"& .MuiFormLabel-root\": {\n      color: \"white\",\n    },\n    \"& .MuiFilledInput-input\": {\n      color: \"white\",\n    },\n    \"& label.Mui-focused\": {\n      color: \"white\",\n    },\n  },\n})(TextField);\n\nexport function LoginPage(props) {\n\n  const inputEl = useRef(null);\n  const onButtonClick = async () => {\n    // `current` points to the mounted text input element\n    const password = inputEl.current.value;\n    const res = await getToken({password});\n    if (!res.error && res.token) {\n      props.appDispatch({type: \"setToken\", payload: res.token});\n      props.appDispatch({type: \"error\", payload: null});\n    } else {\n      props.appDispatch({type: \"error\", payload: \"Heslo nie je spravne\"});\n    }\n  };\n  return (\n    <div>\n\n      <CssTextField\n        fullWidth={true}\n        inputRef={inputEl}\n        required\n        id=\"standard-required\"\n        label=\"Zadaj heslo\"\n        margin=\"normal\"\n        variant=\"filled\"\n      />\n\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        size=\"large\"\n        onClick={onButtonClick}\n      >\n        <LockOpen/>\n        Prihlásiť\n      </Button>\n\n    </div>\n\n\n  )\n}","import {useEffect, useState} from \"react\"\n\nexport const useGeolocation = ({enableHighAccuracy, maximumAge, timeout} = {}, callback) => {\n\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null\n  });\n\n  const [watchId, setWatchId] = useState(0);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n\n    if (navigator.geolocation && !watchId) {\n      navigator.geolocation.getCurrentPosition(({coords}) => {\n        setError(null);\n        setState({\n          accuracy: coords.accuracy,\n          altitude: coords.altitude,\n          altitudeAccuracy: coords.altitudeAccuracy,\n          heading: coords.heading,\n          latitude: coords.latitude,\n          longitude: coords.longitude,\n          speed: coords.speed\n        });\n      }, (err) => {\n        setError(err);\n      });\n      const newWatchId = navigator.geolocation.watchPosition(({coords}) => {\n          setError(null);\n          setState({\n            accuracy: coords.accuracy,\n            altitude: coords.altitude,\n            altitudeAccuracy: coords.altitudeAccuracy,\n            heading: coords.heading,\n            latitude: coords.latitude,\n            longitude: coords.longitude,\n            speed: coords.speed\n          });\n        },\n        (err) => {\n          setError(null);\n        },\n        {enableHighAccuracy, maximumAge, timeout}\n      );\n\n      setWatchId(newWatchId);\n    } else {\n      console.error(\"there is no geo location allowed\");\n    }\n    return () => {\n      if (watchId) {\n        navigator.geolocation.clearWatch(watchId);\n      }\n    }\n  }, []);\n\n  return [state, error];\n};\n\n","import {saveUserToken} from \"./App\";\n\nexport function reducer(state, action) {\n  switch (action.type) {\n    case \"isLoading\":\n      return {...state, isLoading: action.payload};\n\n      case \"image\":\n      return {...state, image: action.payload};\n\n    case \"showSuccess\":\n      return {...state, showSuccess: action.payload};\n\n    case \"error\":\n      return {...state, error: action.payload};\n    default:\n      throw new Error();\n  }\n}\n\nexport function appReducer(state, action) {\n  switch (action.type) {\n    case \"isLoading\":\n      return {...state, isLoading: action.payload};\n    case \"error\":\n      return {...state, error: action.payload};\n    case \"setToken\":\n      saveUserToken(action.payload);\n      return {...state, token: action.payload};\n    default:\n      throw new Error();\n  }\n}","import CircularProgress from \"@material-ui/core/CircularProgress\";\nimport React, {useReducer} from \"react\";\nimport \"./css/App.css\";\nimport logo from \"./images/inteles_logo.svg\";\nimport {LoginPage} from \"./pages/loginPage\";\nimport {MainPage} from \"./pages/mainPage\";\nimport {appReducer} from \"./reducer\";\nimport {VERSION} from \"./version\";\nimport * as Sentry from '@sentry/browser';\nSentry.init({ dsn: 'https://9df3887ac0ee42dba66059dade9b716f@sentry.io/1256606' });\n\n\nexport const TOKEN_NAME = \"jwt-inteles-token\";\n\nexport function getUserToken() {\n  return localStorage.getItem(TOKEN_NAME);\n}\n\nexport function saveUserToken(token) {\n  return localStorage.setItem(TOKEN_NAME, token);\n}\n\nconst defaultAppState = {\n  isLoading: false,\n  error: undefined,\n  token: getUserToken()\n};\n\nfunction App() {\n  const [appState, dispatch] = useReducer(appReducer, defaultAppState);\n\n  // const {isLoading, error, token} = useUserToken();\n  return (\n    <div className=\"App\">\n      <div>\n        <img src={logo} className=\"logo\" alt=\"Inteles logo\"/>\n      </div>\n      <h2>Time tracker</h2>\n\n      {appState.error && <div style={{color: \"red\"}}>{appState.error}</div>}\n      {appState.isLoading && <CircularProgress size={24}/>}\n\n      {appState.token && <MainPage/>}\n      {!appState.isLoading && !appState.token && <LoginPage appDispatch={dispatch}/>}\n\n      <div style={{\n        position: \"absolute\",\n        bottom: 0,\n        color: \"#888\",\n        fontSize: \"0.8rem\",\n        padding: \"0 1rem 1rem 1rem\"\n      }}>GPS Geo Localization version: {VERSION}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import styled from \"@emotion/styled\";\nimport Button from \"@material-ui/core/Button\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport {green} from \"@material-ui/core/colors\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport PlayArrow from \"@material-ui/icons/PlayArrow\";\nimport SaveAlt from \"@material-ui/icons/SaveAlt\";\nimport Stop from \"@material-ui/icons/Stop\";\nimport * as Sentry from \"@sentry/browser\";\nimport CameraPhoto, {FACING_MODES} from \"jslib-html5-camera-photo\";\nimport React, {useEffect, useReducer, useState} from \"react\";\nimport {save, saveImage} from \"../api\";\nimport {getUserToken} from \"../App\";\nimport {useGeolocation} from \"../hooks/useGeoLocation\";\nimport {useRefCallback} from \"../hooks/useRefCallback\";\nimport {reducer} from \"../reducer\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    alignItems: \"center\",\n    background: \"linear-gradient(45deg, #6c757d 30%, #7f8890 90%)\",\n    color: \"white\",\n    padding: \"3rem\",\n    width: \"100%\"\n  },\n  buttonSuccess: {\n    width: \"100%\",\n    backgroundColor: green[500],\n    \"&:hover\": {\n      backgroundColor: green[700],\n    },\n  },\n  buttonProgress: {\n    color: green[500],\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"50%\",\n    marginTop: -12,\n    marginLeft: -12,\n  },\n}));\n\nconst initialState = {\n  isLoading: false,\n  showSuccess: false,\n  image: \"\"\n};\n\nlet cameraPhotoInstance;\nlet tryToStart = false;\n\nasync function handleStart(type, dispatch, geolocation) {\n\n  dispatch({payload: \"\", type: \"error\"});\n  dispatch({payload: true, type: \"isLoading\"});\n  const userToken = getUserToken();\n\n  try {\n    const res = await save({\n      type,\n      lat: geolocation.latitude,\n      lng: geolocation.longitude,\n      token: userToken,\n    });\n    if (!res) {\n      dispatch({payload: \"Nepodarilo sa zapisat. Skúste ešte raz alebo neskôr.\", type: \"error\"});\n    } else if (tryToStart) {\n\n      const config = {\n        sizeFactor: 1,\n        imageType: \"jpg\",\n        imageCompression: 0.95\n      };\n      let dataUri = cameraPhotoInstance.getDataUri(config);\n\n      saveImage({image: dataUri, userToken, logId: res.id});\n      dispatch({payload: true, type: \"showSuccess\"});\n    }\n  } catch (err) {\n    dispatch({payload: \"Nepodarilo sa spojiť so serverom. Skúste ešte raz alebo neskôr.\", type: \"error\"});\n  }\n\n  dispatch({isLoading: false, type: \"isLoading\"});\n}\n\nexport const BtnContainer = styled.div`\n  position:relative;\n  margin:1rem;\n`;\n\nlet timer;\n\nexport function MainPage() {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const classes = useStyles();\n  const [videoNode, setVideoNode] = useRefCallback();\n  const [isCameraStarted, setIsCameraStarted] = useState(false);\n\n  const [geolocation, geoError] = useGeolocation({\n    enableHighAccuracy: true,\n    maximumAge: 15,\n    timeout: 12\n  });\n\n  if (state.showSuccess && !timer) {\n    timer = setTimeout(() => {\n      dispatch({type: \"showSuccess\", payload: false});\n      clearInterval(timer);\n      timer = undefined;\n    }, 4000);\n  }\n\n  useEffect(() => {\n    if (videoNode && !cameraPhotoInstance && !tryToStart) {\n      tryToStart = true;\n      cameraPhotoInstance = new CameraPhoto(videoNode);\n      \n      if (cameraPhotoInstance) {\n        cameraPhotoInstance.startCamera(FACING_MODES.USER)\n          .then((stream) => {\n            if (!isCameraStarted) {\n              setIsCameraStarted(true);\n              console.log(\"camera started\");\n            }\n          })\n          .catch((error) => {\n            console.log(\"error\", error);\n            Sentry.captureException(error);\n          });\n      } else {\n        Sentry.captureException({msg: \"User camera is not supported.\"});\n      }\n    }\n  }, [videoNode, cameraPhotoInstance]);\n\n  if (geoError && geoError.error && geoError.error.message) {\n    return (\n      <div style={{color: \"red\"}}>{geoError.error.message}</div>\n    )\n  }\n\n  return (\n    <>\n      <video width={1} height={1} ref={setVideoNode} autoPlay={true}/>\n      {state.error && <div style={{color: \"red\"}}>{state.error}</div>}\n\n      {state.showSuccess && (<div style={{color: \"#1dc100\"}}><SaveAlt/> Uložené</div>)}\n\n      {state.image && <img src={state.image} alt={\"photo\"}/>}\n\n      <BtnContainer>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          size=\"large\"\n          className={classes.root}\n          disabled={state.isLoading || state.showSuccess}\n          onClick={() => handleStart(\"arrival\", dispatch, geolocation)}\n        >\n          <PlayArrow/>\n          Príchod\n        </Button>\n        {state.isLoading && <CircularProgress size={24} className={classes.buttonProgress}/>}\n      </BtnContainer>\n\n      <BtnContainer>\n        <Button\n          className={classes.root}\n          disabled={state.isLoading || state.showSuccess}\n          onClick={() => handleStart(\"leave\", dispatch, geolocation)}\n        >\n          <Stop/>\n          Odchod\n        </Button>\n        {state.isLoading && <CircularProgress size={24} className={classes.buttonProgress}/>}\n      </BtnContainer>\n    </>\n  )\n}","import {useCallback, useState} from \"react\";\n\nexport function useRefCallback() {\n  const [node, setNode] = useState(null);\n  const setRef = useCallback((element) => {\n    setNode(element);\n  }, []);\n\n  return [node, setRef];\n}\n","export const VERSION = 'v.3.4.4';","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/inteles_logo.2e90362d.svg\";"],"sourceRoot":""}